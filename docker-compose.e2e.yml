services:
  # E2E override: keep OpenClaw state isolated from repo working tree.
  openclaw-gateway:
    # Named volumes are root-owned by default; run as root so the gateway can
    # create its state directories under /home/node/.openclaw.
    user: "0:0"
    command:
      [
        "gateway",
        "--bind",
        "${OPENCLAW_GATEWAY_BIND:-lan}",
        "--port",
        "18789",
        "--allow-unconfigured",
        "--auth",
        "token",
        "--token",
        "${OPENCLAW_GATEWAY_TOKEN}",
      ]
    volumes:
      - openclaw_state:/home/node/.openclaw
      - openclaw_workspace:/home/node/.openclaw/workspace

  openclaw-cli:
    # Same reason as gateway: needs to read/write the shared state volume.
    user: "0:0"
    volumes:
      - openclaw_state:/home/node/.openclaw
      - openclaw_workspace:/home/node/.openclaw/workspace

volumes:
  openclaw_state:
  openclaw_workspace:

